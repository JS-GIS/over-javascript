## 一 请求处理

### 1.0 表单提交

在进行表单提交的时候，必须设置提交方式：
```html
<form action="/user" method="post">

	username:<input type="text" name="username" /><br>
	
	password:<input type="password" name="password" /> <br>
	
	<input type="submit" value="登录">

</form>
```

表单的提交方式有：
- application/x-www-form-urlencoded：默认提交方式，即url编码方式
- text/plain：用的很少，纯文字提交
- multipart/form-data：提交文件

### 1.1 GET请求

```JavaScript
const http = require('http');
const url = require('url');

http.createServer((req,res)=>{
    //true代表直接将结果解析为json
    let {pathname,query} = url.parse(req.url,true);
    console.log(pathname);      //输出请求地址 /get
    console.log(query);         //参数对象  {name:'lisi'}
    res.end('hello');
}).listen(8000);
```

### 1.2 POST请求

```JavaScript
const http = require('http');
const querystring = require('querystring');
http.createServer((req,res)=>{
    let str = '';
    req.on('data',data=>{
         str += data;
    });
    req.on('end',()=>{
        let postData = querystring.parse(str);
        console.log(postData);  // 输出json格式
    });
    res.end();
}).listen(8000);
```

## 二  文件上传

### 2.1 原生文件上传

在POST请求说明中，使用了字符串变量str来接收，如果上传的是文本文件，则仍然是正确的，但是如果上传的是图片、音频等，这里就无法实现了，我们可以使用数组的形式保存：
```JavaScript
const http = require('http');
let server = http.createServer(function (req,res) {
    let arr = [];
    req.on('data',function (data) {
        arr.push(data);
    });
    req.on('end',function () {
        let buf = Buffer.concat(arr);
        console.log(buf.toString());
        res.end();
    });
});
server.listen(8000,function () {
    console.log('server is started...');
});
```

### 2.2 第三方模块 formidable 
```JavaScript
const url = require('url');
const http = require('http');
const path = require('path');

const formidable = require('formidable');

http.createServer(function (req,res) {
    let pathname = url.parse(req.url).pathname;
    if (pathname == '/upload' && req.method.toLowerCase() == "post") {
        uploading(req,res);
    }
}).listen(3000);

//图片上传的方法
function uploading(req,res) {
    let form = new formidable.IncomingForm();
    form.uploadDir = path.join(__dirname, './upload');
    form.parse(req, function (err, fields, files) {
        if (err) throw err;
        res.writeHead(200, {'content-type': 'text/plain;charset=utf8'});
        res.end('上传成功');
    });
}
```

